{
    "Rules" :
    [
        {
            "RuleName" : "Accumulator Example",
            "SourceEvents" :
            [
                {
                    "EventName" : "RegistryWrite",
                    "ConnectTo" : { "MatchPath1" : { "SignalParameter":"#MACRO#Context.Event.Path" } }
                },
            ],
            "Primitives":
            [
                {
                    "Type" : "StringFilter",
                    "Name" : "MatchPath1",
                    "Parameters" : {
                        "Method" : "MatchSingle",
                        "Condition" : "Equals",
                        "MatchTo" : "path_1"
                    },
                    "ConnectTo" : { 
                        "MatchName1" : { "SignalParameter" : "#MACRO#Context.Event.RegValueName" },
                        "MatchPath2" : { "SignalParameter" : "#MACRO#Context.Event.Path", "TriggerOnNegative" : true },
                    }
                },
                {
                    "Type" : "StringFilter",
                    "Name" : "MatchName1",
                    "Parameters" : {
                        "Method" : "MatchSingle",
                        "Condition" : "Equals",
                        "MatchTo" : "name_1"
                    },
                    "ConnectTo" : { 
                        "AccumulateScore" : { "SignalParameter" : 20 },
                        "MatchPath2" : { "SignalParameter" : "#MACRO#Context.Event.Path", "TriggerOnNegative" : true },
                    }
                },
                {
                    "Type" : "StringFilter",
                    "Name" : "MatchPath2",
                    "Parameters" : {
                        "Method" : "MatchSingle",
                        "Condition" : "Equals",
                        "MatchTo" : "path_2"
                    },
                    "ConnectTo" : { 
                        "MatchValue" : { "SignalParameter" : "#MACRO#Context.Event.RegValue" },
                    }
                },
                {
                    "Type" : "IntegerFilter",
                    "Name" : "MatchValue",
                    "Parameters" : {
                        "Condition" : "OneOf",
                        "CompareTo" : [0, 1]
                    },
                    "ConnectTo" : { 
                        "AccumulateScore" : { "SignalParameter" : 30 },
                    }
                },
                {
                    "Type" : "Accumulator",
                    "Name" : "AccumulateScore",
                    "Parameters" : { "Threshold" : 60 },
                    "ConnectTo" : { "EventGenerator_1" : {} }
                },
                {
                    "Type" : "EventGenerator",
                    "Name" : "EventGenerator_1",
                    "Parameters" : { 
                        "NewEventName" : "RegistryAlert",
                        "Properties" : {
                            "Score" : "#MACRO#Contexts[0]"
                        }
                    }
                }
            ],
        }
    ]
}